# ════════════════════════════════════════════════════════════════════════════════
# WAH4H Backend - Environment Variables Template
# ════════════════════════════════════════════════════════════════════════════════
# 
# INSTRUCTIONS:
# 1. Copy this file to .env
# 2. Fill in your actual values
# 3. NEVER commit .env to version control
# 4. Different values required for local/staging/production
#
# ════════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────────
# DJANGO SECURITY CONFIGURATION
# ─────────────────────────────────────────────────────────────────────────────────
# CRITICAL: These values MUST differ between local/staging/production

# Cryptographic key for session encryption and CSRF tokens
# Generate with: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
# ⚠️  REQUIRED | Must be 50+ characters | Change for each environment | DO NOT SHARE
DJANGO_SECRET_KEY=your-secret-key-here-change-in-production

# Enable developer-friendly error pages and console logging
# LOCAL: True | STAGING: False | PRODUCTION: False
# ⚠️  CRITICAL: Must be False in production (shows sensitive information)
DEBUG=False

# Comma-separated list of allowed hostnames
# LOCAL: localhost,127.0.0.1 | STAGING: staging.wah4h.ph | PRODUCTION: api.wah4h.ph,wah4h.ph
# ⚠️  REQUIRED | Controls HTTP Host header validation | Prevents Host Header Injection attacks
ALLOWED_HOSTS=localhost,127.0.0.1,staging.wah4h.ph,api.wah4h.ph

# ─────────────────────────────────────────────────────────────────────────────────
# DATABASE CONFIGURATION
# ─────────────────────────────────────────────────────────────────────────────────
# Django uses DATABASE_URL format for flexibility, or individual DB_* variables

# Option 1: PostgreSQL (recommended for production)
# Format: postgresql://user:password@host:port/database
# LOCAL: sqlite:///db.sqlite3 | STAGING/PRODUCTION: postgresql://...
# Note: If using PostgreSQL, ensure connection pooling is configured (pgBouncer/PgPool)
DATABASE_URL=sqlite:///db.sqlite3

# Option 2: Individual database variables (if DATABASE_URL not set)
# Only used if DATABASE_URL is empty
DB_ENGINE=django.db.backends.sqlite3
DB_NAME=db.sqlite3
DB_USER=postgres
DB_PASSWORD=your-database-password
DB_HOST=localhost
DB_PORT=5432

# ─────────────────────────────────────────────────────────────────────────────────
# WAH4PC GATEWAY INTEGRATION (Hospital Interoperability Network)
# ─────────────────────────────────────────────────────────────────────────────────
# Obtained from: WAH4PC Gateway Administrator after provider registration

# Base URL of the WAH4PC Gateway (includes protocol + domain)
# LOCAL: http://localhost:3000 | STAGING/PRODUCTION: https://wah4pc.echosphere.cfd
# ⚠️  REQUIRED | Must use HTTPS in staging/production | Used for all outbound requests to gateway
WAH4PC_GATEWAY_URL=https://wah4pc.echosphere.cfd

# API Key for authenticating provider->gateway requests
# Format: wah_<random-string>
# Received from: Gateway administrator after provider registration
# ⚠️  REQUIRED | Treat as a secret | Used in X-API-Key header for gateway API calls | Rotation required annually
WAH4PC_API_KEY=wah_your-api-key-here

# Unique provider identifier (UUID or custom ID)
# Assigned by: Gateway administrator during provider registration
# ⚠️  REQUIRED | Unique per provider | Used for patient source identification | Immutable
WAH4PC_PROVIDER_ID=your-provider-uuid-or-id

# Authentication secret for incoming webhook requests from gateway
# Generate new: python -c "import secrets; print(secrets.token_urlsafe(32))"
# Shared with: Gateway administrator (they use this to authenticate webhook calls to you)
# ⚠️  CRITICAL | Validate all incoming webhook requests | Used in X-Gateway-Auth header validation
#    Gateway must send this exact value in X-Gateway-Auth header
GATEWAY_AUTH_KEY=your-gateway-auth-key-changeme

# ─────────────────────────────────────────────────────────────────────────────────
# SSL/TLS & SECURITY HEADERS (Staging/Production Only)
# ─────────────────────────────────────────────────────────────────────────────────
# Controls HTTPS enforcement and secure cookie settings

# Force all requests to HTTPS (except health checks)
# LOCAL: False | STAGING: True | PRODUCTION: True
# ⚠️  CRITICAL in production to prevent man-in-the-middle attacks
SECURE_SSL_REDIRECT=False

# Only send cookies over HTTPS connections
# LOCAL: False | STAGING: True | PRODUCTION: True
# ⚠️  Prevents session hijacking via HTTP
SESSION_COOKIE_SECURE=False

# Only send CSRF token over HTTPS connections
# LOCAL: False | STAGING: True | PRODUCTION: True
# ⚠️  Prevents CSRF token exposure via HTTP
CSRF_COOKIE_SECURE=False

# Enable HTTP Strict-Transport-Security header
# LOCAL: False | STAGING: True | PRODUCTION: True
# ⚠️  Prevents protocol downgrade attacks | Tells browsers to always use HTTPS
SECURE_HSTS_SECONDS=0

# Include subdomains in HSTS policy
# LOCAL: False | STAGING: True | PRODUCTION: True
SECURE_HSTS_INCLUDE_SUBDOMAINS=False

# Allow browser to preload HSTS policy
# LOCAL: False | STAGING: False | PRODUCTION: True (optional)
SECURE_HSTS_PRELOAD=False

# ─────────────────────────────────────────────────────────────────────────────────
# CORS & CSRF CONFIGURATION (Frontend Communication)
# ─────────────────────────────────────────────────────────────────────────────────
# Controls which domains can make requests to this backend

# Comma-separated list of allowed frontend origins
# LOCAL: http://localhost:5173,http://localhost:3000 (Vite default ports)
# STAGING: https://staging-app.wah4h.ph
# PRODUCTION: https://app.wah4h.ph
# ⚠️  CRITICAL | Whitelist only trusted domains | Controls Cross-Origin Resource Sharing
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# Comma-separated list of trusted origins for CSRF validation
# Must include all domains that POST to this backend
# LOCAL: http://localhost:5173,http://localhost:3000
# STAGING: https://staging-app.wah4h.ph
# PRODUCTION: https://app.wah4h.ph
# ⚠️  CRITICAL | Prevents CSRF attacks from malicious websites
CSRF_TRUSTED_ORIGINS=http://localhost:5173,http://localhost:3000

# ─────────────────────────────────────────────────────────────────────────────────
# PUBLIC URL CONFIGURATION (For Webhook Callbacks)
# ─────────────────────────────────────────────────────────────────────────────────
# Used when gateway needs to call your webhooks (for patient data delivery)

# Your publicly accessible base URL (must be HTTPS in production)
# LOCAL: Use ngrok: https://your-ngrok-url.ngrok.io (for local testing against real gateway)
# STAGING: https://staging-api.wah4h.ph or https://staging.wah4h.ph
# PRODUCTION: https://api.wah4h.ph or https://wah4h.ph/api
# ⚠️  REQUIRED | Must be internet-accessible for gateway to call back | MUST use HTTPS in staging/production
PUBLIC_BASE_URL=http://localhost:8000

# ─────────────────────────────────────────────────────────────────────────────────
# EMAIL CONFIGURATION (OTP & Notifications)
# ─────────────────────────────────────────────────────────────────────────────────
# Using Gmail SMTP (can be replaced with organization SMTP server)

# SMTP server address
# Gmail: smtp.gmail.com | Organization: smtp.your-org.com
EMAIL_HOST=smtp.gmail.com

# SMTP port (TLS: 587, SSL: 465)
EMAIL_PORT=587

# Gmail app password or SMTP credentials
# For Gmail: Generate app password at https://myaccount.google.com/apppasswords
# ⚠️  CRITICAL | Store securely | Used to send OTP emails
EMAIL_HOST_USER=your-email@gmail.com

# Email authentication password
# ⚠️  CRITICAL | Use app password for Gmail, not account password
EMAIL_HOST_PASSWORD=your-app-password

# ─────────────────────────────────────────────────────────────────────────────────
# LOGGING CONFIGURATION
# ─────────────────────────────────────────────────────────────────────────────────
# Controls verbosity of application logs

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
# LOCAL: DEBUG | STAGING: INFO | PRODUCTION: WARNING or ERROR
# DEBUG logs sensitive information; use INFO in staging, WARNING+ in production
LOG_LEVEL=DEBUG

# ─────────────────────────────────────────────────────────────────────────────────
# OPTIONAL: CACHE CONFIGURATION (for production scalability)
# ─────────────────────────────────────────────────────────────────────────────────
# Defaults to in-memory cache; use Redis for multi-server deployments

# Cache backend (locmem for development, redis for production)
# LOCAL: locmem | STAGING/PRODUCTION: redis
# REMOVE or leave blank to use default in-memory cache
CACHE_BACKEND=django.core.cache.backends.locmem.LocMemCache

# Redis URL (only used if CACHE_BACKEND contains 'redis')
# Format: redis://:password@host:port/database
# REDIS_URL=redis://localhost:6379/1

# ─────────────────────────────────────────────────────────────────────────────────
# OPTIONAL: SENTRY (Error Tracking)
# ─────────────────────────────────────────────────────────────────────────────────
# Automatically capture and report errors to Sentry dashboard
# Only recommended for staging/production

# Sentry DSN (Data Source Name)
# Obtain from: https://sentry.io/ (create account and project)
# REMOVE or leave blank to disable error reporting
# SENTRY_DSN=https://xxx@yyy.ingest.sentry.io/zzz

# ─────────────────────────────────────────────────────────────────────────────────
# REFERENCE: ENVIRONMENT-SPECIFIC CHECKLIST
# ─────────────────────────────────────────────────────────────────────────────────
#
# LOCAL DEVELOPMENT:
#   ✓ DEBUG=True (for detailed error messages)
#   ✓ ALLOWED_HOSTS=localhost,127.0.0.1
#   ✓ SECURE_SSL_REDIRECT=False
#   ✓ SESSION_COOKIE_SECURE=False
#   ✓ CSRF_COOKIE_SECURE=False
#   ✓ CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000
#   ✓ DATABASE_URL=sqlite (or local PostgreSQL)
#   ✓ WAH4PC_GATEWAY_URL=http://localhost:3000 (or ngrok URL)
#
# STAGING ENVIRONMENT:
#   ✓ DEBUG=False (never True in staging/production)
#   ✓ ALLOWED_HOSTS=staging.wah4h.ph
#   ✓ SECURE_SSL_REDIRECT=True
#   ✓ SESSION_COOKIE_SECURE=True
#   ✓ CSRF_COOKIE_SECURE=True
#   ✓ SECURE_HSTS_SECONDS=31536000 (1 year)
#   ✓ CORS_ALLOWED_ORIGINS=https://staging-app.wah4h.ph
#   ✓ DATABASE_URL=postgresql://...
#   ✓ WAH4PC_GATEWAY_URL=https://wah4pc.echosphere.cfd (production gateway)
#   ✓ PUBLIC_BASE_URL=https://staging-api.wah4h.ph
#   ✓ All sensitive keys rotated
#
# PRODUCTION ENVIRONMENT:
#   ✓ DEBUG=False (CRITICAL!)
#   ✓ ALLOWED_HOSTS=api.wah4h.ph,wah4h.ph (no wildcards)
#   ✓ SECURE_SSL_REDIRECT=True
#   ✓ SESSION_COOKIE_SECURE=True
#   ✓ CSRF_COOKIE_SECURE=True
#   ✓ SECURE_HSTS_SECONDS=31536000
#   ✓ SECURE_HSTS_INCLUDE_SUBDOMAINS=True
#   ✓ SECURE_HSTS_PRELOAD=True (optional but recommended)
#   ✓ CORS_ALLOWED_ORIGINS=https://app.wah4h.ph (frontend domain only)
#   ✓ DATABASE_URL=postgresql://... (with connection pooling)
#   ✓ CACHE_BACKEND=redis
#   ✓ LOG_LEVEL=WARNING
#   ✓ All credentials rotated and latest versions
#   ✓ SENTRY_DSN configured for error tracking
#   ✓ PUBLIC_BASE_URL=https://api.wah4h.ph (must be HTTPS)
#
# ════════════════════════════════════════════════════════════════════════════════
